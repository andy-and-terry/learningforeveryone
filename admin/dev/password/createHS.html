<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <title>SHG</title>
  <script>
    document.addEventListener('contextmenu', function(event) {
    event.preventDefault();
});
  </script>
</head>
<body>

<h3>Salt + Hash Generator</h3>

<input id="pw" placeholder="password">
<button onclick="go()">Generate</button>

<pre id="out"></pre>

<script>
async function generate(password) {
  const salt = crypto.getRandomValues(new Uint8Array(16));

  const keyMaterial = await crypto.subtle.importKey(
    "raw",
    new TextEncoder().encode(password),
    "PBKDF2",
    false,
    ["deriveBits"]
  );

  const bits = await crypto.subtle.deriveBits(
    {
      name: "PBKDF2",
      hash: "SHA-256",
      salt: salt,
      iterations: 150000
    },
    keyMaterial,
    256
  );

  const saltB64 = btoa(String.fromCharCode(...salt));
  const hashB64 = btoa(String.fromCharCode(...new Uint8Array(bits)));

  return { salt: saltB64, hash: hashB64 };
}

async function go() {
  const pw = document.getElementById("pw").value;
  const r = await generate(pw);
  document.getElementById("out").textContent =
`"salt": "${r.salt}",
"hash": "${r.hash}"`;
}
</script>

</body>
